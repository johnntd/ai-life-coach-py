<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>AI Life Coach</title>
  <link rel="icon" href="/static/favicon.ico" />
  <style>
    :root{
      --bg:#0b1220;--ink:#e5e7eb;--muted:#9ca3af;--card:#0f172a;--pill:#111827;
      --coach:#d1fae5;--you:#bfdbfe
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;background:var(--bg);color:var(--ink);font:16px/1.4 ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto}
    .wrap{max-width:1100px;margin:24px auto;padding:0 16px}
    header{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
    h1{margin:0;font-size:22px}
    .pill{background:var(--pill);border:1px solid #1f2937;border-radius:999px;padding:6px 10px;color:var(--muted);font-size:12px}
    .card{background:var(--card);border:1px solid #1f2937;border-radius:14px;padding:12px}
    .row{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
    .grow{flex:1}
    .btn{background:#2563eb;border:0;color:white;padding:10px 14px;border-radius:10px;cursor:pointer}
    .btn.secondary{background:#374151}
    .btn:disabled{opacity:.5;cursor:not-allowed}
    input,select{background:#0b1220;border:1px solid #1f2937;color:var(--ink);padding:10px;border-radius:10px}
    .log{height:480px;overflow:auto;display:flex;flex-direction:column;gap:8px}
    .bubble{padding:10px 12px;border-radius:10px;max-width:85%}
    .you{background:var(--you);color:#0b1220;align-self:flex-end}
    .coach{background:var(--coach);color:#0b1220;align-self:flex-start}
    footer{margin-top:8px;color:var(--muted);font-size:12px;display:flex;justify-content:space-between;gap:8px;flex-wrap:wrap}
    .avatar{width:56px;height:56px;border-radius:12px;object-fit:cover;border:1px solid #1f2937}

    /* Non‑blocking mic toast (replaces the old fullscreen blur) */
    #consentToast{
      position:fixed;left:50%;transform:translateX(-50%);
      bottom:22px;z-index:50;display:none;
      background:#111827;border:1px solid #1f2937;border-radius:14px;
      padding:14px 16px;max-width:520px;width:92%;
      box-shadow:0 10px 30px rgba(0,0,0,.35)
    }
    #consentToast.show{display:flex;gap:12px;align-items:center;justify-content:space-between;flex-wrap:wrap}
    #consentToast .text{color:#d1d5db;font-size:14px}
    #consentToast .actions{display:flex;gap:8px;align-items:center}
    #consentToast .link{background:transparent;border:0;color:#9ca3af;cursor:pointer}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <img src="/static/avatar.jpg" class="avatar" alt="Miss Sunny" />
      <h1 style="margin-right:8px">AI Life Coach</h1>
      <span class="pill" id="status">Idle</span>
      <span class="pill" id="model">Model: …</span>
      <div class="grow"></div>
      <label class="pill">
        <input type="checkbox" id="teen" /> Teen Mode
      </label>
      <input id="name" placeholder="Child name (e.g., Emily)" value="Emily" />
      <select id="age">
        <option>3</option><option>4</option><option selected>5</option>
        <option>6</option><option>7</option><option>8</option>
      </select>
      <select id="lang">
        <option value="en-US" selected>English</option>
        <option value="vi-VN">Tiếng Việt</option>
      </select>
      <button id="start" class="btn">▶️ Start</button>
      <button id="stop" class="btn secondary" disabled>⏹  Stop</button>
    </header>

    <section class="card log" id="log"></section>

    <div class="row" style="margin-top:10px">
      <input id="text" class="grow" placeholder="(Optional) type a message & Enter" />
      <button id="send" class="btn secondary">Send</button>
    </div>

    <footer>
      <div>Hands‑free after Start. Mic auto‑pauses during coach speech.</div>
      <div>API: <span id="api">/chat</span></div>
    </footer>
  </div>

  <!-- Single audio element for TTS playback -->
  <audio id="ttsAudio" preload="none"></audio>

  <!-- Non‑blocking mic toast -->
  <div id="consentToast">
    <div class="text">Enable mic so Miss Sunny can speak and listen hands‑free.</div>
    <div class="actions">
      <button id="enableStart" class="btn">Enable & Start</button>
      <button id="skipEnable" class="link">Not now</button>
    </div>
  </div>

  <script src="/static/app.js"></script>
</body>
</html>
